+++
title = "FastCGI in Jetty"
date = 2025-08-29T19:59:36.868+01:00
draft = false
description = "This chapter of the Jetty tutorial covers processing of CGI scripts."
image = "images/fastcgi2.png"
imageBig = "images/fastcgi2.png"
categories = ["java"]
authors = ["Cude"]
avatar = "/images/avatar.webp"
+++

[Contents](..)
[Previous](../httpclient/)
[Next](../websocket/)

# FastCGI in Jetty

last modified January 27, 2024

 

Jetty can serve PHP, Python, or Ruby scripts via FastCGI. 
*FastCGI* is a network protocol primarily used by a web server to 
communicate to a FastCGI server. FastCGI servers are used to serve web 
content generated by dynamic web languages including PHP, Python, Ruby, 
Perl and others.

The servlet that processes CGI scripts is called org.eclipse.jetty.servlets.CGI.
This servlet is asynchronous, therefore, we have to add 
the &lt;async-supported&gt;true&lt;/async-supported&gt; to the
web.xml file.

index.html
  

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;body&gt;
        Get environment &lt;a href="cgi-bin/evars.py"&gt;variables&lt;/a&gt;
    &lt;/body&gt;
&lt;/html&gt;

When our web application starts, it shows this simple HTML file. A link refers
to a Python CGI script to get environment variables.

evars.py
  

#!/usr/bin/python

import sys
import os
from cgi import escape

print "Content-type: text/html"
print
print "&lt;!doctype html&gt;"
print "&lt;html&gt;"
print "&lt;body&gt;"
print "&lt;pre&gt;"
for k in sorted(os.environ):
    print "&lt;b&gt;%s: &lt;/b&gt;%s" %(escape(k), escape(os.environ[k]))
print "&lt;/pre&gt;"
print "&lt;/body&gt;"
print "&lt;/html&gt;"

Our example will process this Python script. It creates a simple HTML
page containing environment variables.

web.xml
  

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee 
             http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
         version="3.1"&gt;
  
    &lt;servlet&gt;
        &lt;servlet-name&gt;CGI&lt;/servlet-name&gt;
        &lt;servlet-class&gt;org.eclipse.jetty.servlets.CGI&lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;Path&lt;/param-name&gt;
            &lt;param-value&gt;/bin:/usr/bin:/usr/local/bin&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;cgibinResourceBaseIsRelative&lt;/param-name&gt;
            &lt;param-value&gt;true&lt;/param-value&gt;
        &lt;/init-param&gt;      
        &lt;init-param&gt; 
            &lt;param-name&gt;commandPrefix&lt;/param-name&gt; 
            &lt;param-value&gt;/usr/bin/python&lt;/param-value&gt; 
        &lt;/init-param&gt;         
        &lt;init-param&gt;
            &lt;param-name&gt;cgibinResourceBase&lt;/param-name&gt;
            &lt;param-value&gt;WEB-INF/cgi-bin&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;async-supported&gt;true&lt;/async-supported&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
        
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;CGI&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/cgi-bin/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;  
    
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;    
  
&lt;/web-app&gt;

This is the application's web.xml file. It maps the CGI servlet to 
/cgi-bin/* URL pattern. In the welcome file list, we specify the 
index.html file containing a link to a Python script.
The cgibinResourceBaseIsRelative sets the path to the cgi-bin directory
to be relative to the web application document root directory. 
The commandPrefix parameter specifies the path to the Python interpreter.

build.xml
  

&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;project name="FastCGIServlet" default="archive"&gt;
  
    &lt;property name="name" value="cgiexample"/&gt;
    &lt;property environment="env"/&gt;
    &lt;property name="src.dir" value="src"/&gt;
    &lt;property name="web.dir" value="${src.dir}/web"/&gt;
    &lt;property name="dist.dir" location="dist"/&gt;
    &lt;property name="deploy.path" location="${env.JETTY_BASE}/webapps"/&gt;
  
    &lt;target name="init"&gt;
        &lt;mkdir dir="${dist.dir}"/&gt;
    &lt;/target&gt;     
  
    &lt;target name="archive" depends="init"&gt;
        &lt;war destfile="${dist.dir}/${name}.war" 
             webxml="${web.dir}/WEB-INF/web.xml"&gt;
            &lt;fileset dir="${web.dir}"/&gt;
        &lt;/war&gt;
        &lt;echo&gt;Archive created&lt;/echo&gt;
    &lt;/target&gt; 
  
    &lt;target name="clean" depends="init"&gt;
        &lt;delete dir="${dist.dir}"/&gt;
        &lt;echo&gt;Cleaning completed&lt;/echo&gt;
    &lt;/target&gt;  
    
    &lt;target name="deploy" depends="archive"&gt;
        &lt;copy file="${dist.dir}/${name}.war" overwrite="true" 
              todir="${deploy.path}"/&gt;
        &lt;echo&gt;Archive deployed&lt;/echo&gt;
    &lt;/target&gt;    
    
&lt;/project&gt;

The Ant archive task creates a web archive containing the index.html file, 
web.xml file and a Python script in the WEB-INF/cgi-bin/ subdirectory.
The deploy task copies the WAR file into the deployment directory of the Jetty base.

$ java -jar $JETTY_HOME/start.jar --add-to-start=http,deploy,servlets

Assuming that we have not yet enabled any module in the Jetty base, we
enable these three modules. The Jetty CGI servlet is in the servlets module.

$ java -jar $JETTY_HOME/start.jar

We start the Jetty server. Now we can navigate to the http://localhost:8080/cgiexample/
URL.

![fastcgi2.png](images/fastcgi2.png)

Figure:Output of the Python script

In this chapter of the Jetty tutorial, we have executed a Python script using
the Jetty's CGI servlet.

## Author

My name is Jan Bodnar, and I am a passionate programmer with extensive
programming experience. I have been writing programming articles since 2007.
To date, I have authored over 1,400 articles and 8 e-books. I possess more
than ten years of experience in teaching programming.

List [all Java tutorials](/java/).

[Contents](..)
[Previous](../httpclient/)
[Next](../websocket/)